module scoring_mechanism_DFF(touchdown, extraPoint, twoPointConversion, fieldGoal, safety, clock, reset, possession, score1tens, score1ones, score2tens, score2ones);
    input touchdown, extraPoint, twoPointConversion, fieldGoal, safety, reset, clock;
    output reg possession;
    output [3:0] score1tens;
    output [3:0] score1ones;
    output [3:0] score2tens;
    output [3:0] score2ones;

    wire [6:0] score1;
    wire [6:0] score2;
    reg [6:0] score1_next;
    reg [6:0] score2_next;

    genvar i;
    generate
        for (i = 0; i < 7; i = i + 1) begin: score1_dffs
            my_dff d1(clock, reset, score1_next[i], score1[i]);
        end
        for (i = 0; i < 7; i = i + 1) begin: score2_dffs
            my_dff d2(clock, reset, score2_next[i], score2[i]);
        end
    endgenerate

    always @(*) begin
        score1_next = score1;
        score2_next = score2;

        if (touchdown) begin
            if (possession)
                score2_next = score2 + 6;
            else
                score1_next = score1 + 6;
        end else if (extraPoint) begin
            if (possession)
                score2_next = score2 + 1;
            else
                score1_next = score1 + 1;
        end else if (twoPointConversion) begin
            if (possession)
                score2_next = score2 + 2;
            else
                score1_next = score1 + 2;
        end else if (fieldGoal) begin
            if (possession)
                score2_next = score2 + 3;
            else
                score1_next = score1 + 3;
        end else if (safety) begin
            if (possession)
                score2_next = score2 + 2;
            else
                score1_next = score1 + 2;
        end
    end

    always @(posedge clock or posedge reset) begin
        if (reset)
            possession <= 1'b0;
        else if (extraPoint || twoPointConversion || fieldGoal || safety)
            possession <= ~possession;
    end

    assign score1tens = score1 / 10;
    assign score1ones = score1 % 10;
    assign score2tens = score2 / 10;
    assign score2ones = score2 % 10;

endmodule
